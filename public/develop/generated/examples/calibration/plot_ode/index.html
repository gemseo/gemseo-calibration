
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://gemseo.gitlab.io/gemseo-calibration/latest/generated/examples/calibration/plot_ode/">
      
      
        <link rel="prev" href="../plot_noise/">
      
      
        <link rel="next" href="../../../../reference/gemseo_calibration/">
      
      
      <link rel="icon" href="../../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Calibrate an ordinary differential equation. - gemseo-calibration</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../../../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../sg_gallery-binder.css">
    
      <link rel="stylesheet" href="../../../../sg_gallery.css">
    
      <link rel="stylesheet" href="../../../../sg_gallery-rendered-html.css">
    
      <link rel="stylesheet" href="../../../../sg_gallery-dataframe.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-problem" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="gemseo-calibration" class="md-header__button md-logo" aria-label="gemseo-calibration" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            gemseo-calibration
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Calibrate an ordinary differential equation.
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://gitlab.com/gemseo/dev/gemseo-calibration" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81s-5.7.083-8.4 1.11c-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.1 18.1 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3s9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82"/></svg>
  </div>
  <div class="md-source__repository">
    gemseo-calibration
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../user_guide/" class="md-tabs__link">
        
  
  
    
  
  User guide

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../reference/gemseo_calibration/" class="md-tabs__link">
        
  
  
    
  
  API documentation

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="gemseo-calibration" class="md-nav__button md-logo" aria-label="gemseo-calibration" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    gemseo-calibration
  </label>
  
    <div class="md-nav__source">
      <a href="https://gitlab.com/gemseo/dev/gemseo-calibration" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="m503.5 204.6-.7-1.8-69.7-181.78c-1.4-3.57-3.9-6.59-7.2-8.64-2.4-1.55-5.1-2.515-8-2.81s-5.7.083-8.4 1.11c-2.7 1.02-5.1 2.66-7.1 4.78-1.9 2.12-3.3 4.67-4.1 7.44l-47 144H160.8l-47.1-144c-.8-2.77-2.2-5.31-4.1-7.43-2-2.12-4.4-3.75-7.1-4.77a18.1 18.1 0 0 0-8.38-1.113 18.4 18.4 0 0 0-8.04 2.793 18.1 18.1 0 0 0-7.16 8.64L9.267 202.8l-.724 1.8a129.57 129.57 0 0 0-3.52 82c7.747 26.9 24.047 50.7 46.447 67.6l.27.2.59.4 105.97 79.5 52.6 39.7 32 24.2c3.7 1.9 8.3 4.3 13 4.3s9.3-2.4 13-4.3l32-24.2 52.6-39.7 106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82"/></svg>
  </div>
  <div class="md-source__repository">
    gemseo-calibration
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../credits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Credits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../licenses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Licenses
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_missing_values/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observations with missing values.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_one_parameter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    One calibration parameter.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_chain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Disciplinary chain.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_constraint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constrained calibration.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_two_parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Two calibration parameters.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_mda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strongly coupled models.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_mesh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functional output discretized on a mesh.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Noisy observations.
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Calibrate an ordinary differential equation.
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Calibrate an ordinary differential equation.
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-data-generator" class="md-nav__link">
    <span class="md-ellipsis">
      The data generator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-simulator" class="md-nav__link">
    <span class="md-ellipsis">
      The simulator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#periodic-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Periodic calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-methodology" class="md-nav__link">
    <span class="md-ellipsis">
      The methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-results" class="md-nav__link">
    <span class="md-ellipsis">
      The results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#one-shot-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      One-shot calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="One-shot calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-methodology_1" class="md-nav__link">
    <span class="md-ellipsis">
      The methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-results_1" class="md-nav__link">
    <span class="md-ellipsis">
      The results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Initial conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initial conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-methodology_2" class="md-nav__link">
    <span class="md-ellipsis">
      The methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-results_2" class="md-nav__link">
    <span class="md-ellipsis">
      The results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../reference/gemseo_calibration/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API documentation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/calibrator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calibrator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/post_processor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Post processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/scenario/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scenario
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../reference/gemseo_calibration/metrics/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/base_calibration_metric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base calibration metric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/base_integrated_metric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base integrated metric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/base_mean_metric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base mean metric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/factory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Factory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/iae/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iae
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/ise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ise
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/mae/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mae
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/mse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/metrics/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../reference/gemseo_calibration/post/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Post
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Post
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/post/factory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Factory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/post/multiple_scatter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiple scatter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../reference/gemseo_calibration/post/data_versus_model/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Data versus model
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_5_3" id="__nav_4_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5_3">
            <span class="md-nav__icon md-icon"></span>
            Data versus model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/post/data_versus_model/post/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Post
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/post/data_versus_model/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../reference/gemseo_calibration/problems/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Problems
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Problems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../reference/gemseo_calibration/problems/signal/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Signal
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_6_1" id="__nav_4_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6_1">
            <span class="md-nav__icon md-icon"></span>
            Signal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/problems/signal/oscillator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oscillator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../reference/gemseo_calibration/signal/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Signal
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Signal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/signal/base_signal_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base signal generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/signal/ode_signal_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ode signal generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/gemseo_calibration/signal/signal_generator_discipline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Signal generator discipline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-data-generator" class="md-nav__link">
    <span class="md-ellipsis">
      The data generator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-simulator" class="md-nav__link">
    <span class="md-ellipsis">
      The simulator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#periodic-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      Periodic calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Periodic calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-methodology" class="md-nav__link">
    <span class="md-ellipsis">
      The methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-results" class="md-nav__link">
    <span class="md-ellipsis">
      The results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#one-shot-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      One-shot calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="One-shot calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-methodology_1" class="md-nav__link">
    <span class="md-ellipsis">
      The methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-results_1" class="md-nav__link">
    <span class="md-ellipsis">
      The results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Initial conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initial conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-methodology_2" class="md-nav__link">
    <span class="md-ellipsis">
      The methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-results_2" class="md-nav__link">
    <span class="md-ellipsis">
      The results
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Calibrate an ordinary differential equation.</h1>

<!--
 DO NOT EDIT.
 THIS FILE WAS AUTOMATICALLY GENERATED BY mkdocs-gallery.
 TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
 "docs/examples/calibration/plot_ode.py"
 LINE NUMBERS ARE GIVEN BELOW.
-->

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Click <a href="#download_links">here</a>
to download the full example code</p>
</div>
<p>Calibrate an ordinary differential equation.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 17-31 -->

<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gemseo.algos.design_space</span><span class="w"> </span><span class="kn">import</span> <span class="n">DesignSpace</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">atleast_2d</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">full</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linspace</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">gemseo_calibration.metrics.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">CalibrationMetricSettings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gemseo_calibration.problems.signal.oscillator</span><span class="w"> </span><span class="kn">import</span> <span class="n">Oscillator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gemseo_calibration.scenario</span><span class="w"> </span><span class="kn">import</span> <span class="n">CalibrationScenario</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gemseo_calibration.signal.signal_generator_discipline</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">SignalGeneratorDiscipline</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 32-53 -->

<h2 id="the-problem">The problem<a class="headerlink" href="#the-problem" title="Permanent link">&para;</a></h2>
<h3 id="the-data-generator">The data generator<a class="headerlink" href="#the-data-generator" title="Permanent link">&para;</a></h3>
<p>In this example,
we will observe a time-dependent angular rate oscillator,
or more precisely a reference model generating synthetic data.
Its state <span class="arithmatex">\(s=(p,v)\)</span>,
defined by its position <span class="arithmatex">\(p\)</span> and its velocity <span class="arithmatex">\(v\)</span>,
is modelled by the ordinary differential equation (ODE)</p>
<div class="arithmatex">\[\frac{ds(t)}{dt}=(v(t),-\omega^2(t) p(t))\]</div>
<p>with <span class="arithmatex">\(p(t_0)=p_0\)</span>, <span class="arithmatex">\(v(t_0)=v_0\)</span> and <span class="arithmatex">\(\omega(t_0)=\omega_0\)</span> at initial time <span class="arithmatex">\(t_0\)</span>:
Its angular velocity <span class="arithmatex">\(\omega\)</span> is also modelled by an ODE:</p>
<div class="arithmatex">\[\frac{d\omega(t)}{dt} = -a\exp(-at)\]</div>
<p>with <span class="arithmatex">\(a=0.02\)</span> and <span class="arithmatex">\(\omega(t_0)=\omega_0\)</span>.</p>
<p>This oscillator can be built as follows:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 53-57 -->

<div class="highlight"><pre><span></span><code><span class="n">omega_0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p_0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">v_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">oscillator</span> <span class="o">=</span> <span class="n">Oscillator</span><span class="p">()</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 58-65 -->

<p>We then seek to simulate the time evolution of its state from observations,
under the assumption that the model of <span class="arithmatex">\(\omega\)</span> is unknown.</p>
<h3 id="the-simulator">The simulator<a class="headerlink" href="#the-simulator" title="Permanent link">&para;</a></h3>
<p>We can approximate this oscillator by a simulator based on an oscillator model
whose angular velocity is constant and set to <span class="arithmatex">\(\omega_0\)</span>:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 65-66 -->

<div class="highlight"><pre><span></span><code><span class="n">simulator</span> <span class="o">=</span> <span class="n">Oscillator</span><span class="p">(</span><span class="n">omega</span><span class="o">=</span><span class="n">omega_0</span><span class="p">)</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 67-70 -->

<p>Unfortunately,
this approximation is too crude, as illustrated
over the time interval <span class="arithmatex">\([t_0,t_n]=[0,20]\)</span>:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 70-91 -->

<div class="highlight"><pre><span></span><code><span class="n">t_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">t_n</span> <span class="o">=</span> <span class="mf">20.0</span>
<span class="n">n_nodes</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_n</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">oscillator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">omega_0</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">p_0</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">v_0</span><span class="p">})</span>
<span class="n">simulations</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">p_0</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">v_0</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">],</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Oscillator&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">simulations</span><span class="o">.</span><span class="n">times</span><span class="p">,</span>
    <span class="n">simulations</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">],</span>
    <span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Simulator&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="plot ode" class="mkd-glr-single-img" src="../images/mkd_glr_plot_ode_001.png" srcset="../images/mkd_glr_plot_ode_001.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 92-102 -->

<p>This difference is perfectly understandable,
since if we look at the observations of the oscillator,
we can deduce that its angular velocity evolves with time.
It is therefore in our interest to take this information into account,
either by changing its value regularly or by using a parametric model for <span class="arithmatex">\(\omega\)</span>.</p>
<h2 id="periodic-calibration">Periodic calibration<a class="headerlink" href="#periodic-calibration" title="Permanent link">&para;</a></h2>
<h3 id="the-methodology">The methodology<a class="headerlink" href="#the-methodology" title="Permanent link">&para;</a></h3>
<p>We therefore seek to calibrate this simulator:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 102-103 -->

<div class="highlight"><pre><span></span><code><span class="n">calibrated_simulator</span> <span class="o">=</span> <span class="n">Oscillator</span><span class="p">(</span><span class="n">omega</span><span class="o">=</span><span class="n">omega_0</span><span class="p">)</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 104-106 -->

<p>at <span class="arithmatex">\(m=10\)</span> times <span class="arithmatex">\((t_i)_{1\leq i \leq m}\)</span> equally spaced with time step <span class="arithmatex">\(\delta\)</span>
over the interval <span class="arithmatex">\([t_0,t_n]\)</span>:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 106-111 -->

<div class="highlight"><pre><span></span><code><span class="n">m</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t_i</span> <span class="o">=</span> <span class="n">t_0</span>
<span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_n</span> <span class="o">-</span> <span class="n">t_0</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">n_sub_nodes</span> <span class="o">=</span> <span class="n">n_nodes</span> <span class="o">//</span> <span class="n">n</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 112-113 -->

<p>by varying <span class="arithmatex">\(\omega\)</span> over the interval <span class="arithmatex">\([0.5,3]\)</span>:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 113-115 -->

<div class="highlight"><pre><span></span><code><span class="n">search_space</span> <span class="o">=</span> <span class="n">DesignSpace</span><span class="p">()</span>
<span class="n">search_space</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;omega&quot;</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">omega_0</span><span class="p">)</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 116-118 -->

<p>in order to minimize
the mean squared error of the position of the <code>calibrated_simulator</code>.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 118-119 -->

<div class="highlight"><pre><span></span><code><span class="n">output_name</span> <span class="o">=</span> <span class="s2">&quot;position&quot;</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 120-128 -->

<p>In the following,
we mimic the sequential acquisition of observations from the <code>oscillator</code>
using a for-loop in which we use a
<a class="autorefs autorefs-internal" title="            CalibrationScenario" href="../../../../reference/gemseo_calibration/scenario/#gemseo_calibration.scenario.CalibrationScenario">CalibrationScenario</a>
to calibrate the <code>calibrated_simulator</code> every <span class="arithmatex">\(\delta\)</span> seconds
and execute the <code>simulator</code> with the constant angular velocity.
First,
we initialize the state variables of the ODEs:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 128-136 -->

<div class="highlight"><pre><span></span><code><span class="n">initial_oscillator_omega</span> <span class="o">=</span> <span class="n">omega_0</span>
<span class="n">initial_oscillator_position</span> <span class="o">=</span> <span class="n">p_0</span>
<span class="n">initial_oscillator_velocity</span> <span class="o">=</span> <span class="n">v_0</span>
<span class="n">initial_simulator_position</span> <span class="o">=</span> <span class="n">p_0</span>
<span class="n">initial_simulator_velocity</span> <span class="o">=</span> <span class="n">v_0</span>
<span class="n">initial_calibrated_simulator_position</span> <span class="o">=</span> <span class="n">p_0</span>
<span class="n">initial_calibrated_simulator_velocity</span> <span class="o">=</span> <span class="n">v_0</span>
<span class="n">new_omega</span> <span class="o">=</span> <span class="p">[</span><span class="n">full</span><span class="p">(</span><span class="n">n_sub_nodes</span><span class="p">,</span> <span class="n">omega_0</span><span class="p">),</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 137-145 -->

<p>and then,
at each calibration time <span class="arithmatex">\(t_i\)</span>,
we</p>
<ol>
<li>plot the observations acquired by <code>oscillator</code> over <span class="arithmatex">\([t_{i-1},t_i]\)</span>,</li>
<li>generate simulations with the <code>simulator</code>  over <span class="arithmatex">\([t_{i-1},t_i]\)</span> and plot them,</li>
<li>calibrate the <code>calibrated_simulator</code> over <span class="arithmatex">\([t_{i-1},t_i]\)</span>,
   generate simulations and plot them.</li>
</ol>
<!-- GENERATED FROM PYTHON SOURCE LINES 145-278 -->

<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># The times of interest, from the initial time to the calibration time.</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">t_i</span><span class="p">,</span> <span class="n">t_i</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n_sub_nodes</span><span class="p">)</span>

    <span class="c1"># Generation of reference data at times of interest.</span>
    <span class="n">oscillator_signal</span> <span class="o">=</span> <span class="n">oscillator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">initial_oscillator_omega</span><span class="p">,</span>
            <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">initial_oscillator_position</span><span class="p">,</span>
            <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">initial_oscillator_velocity</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="c1"># Generation of simulations at times of interest with the uncalibrated simulator.</span>
    <span class="n">simulator_signal</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">initial_simulator_position</span><span class="p">,</span>
            <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">initial_simulator_velocity</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="c1"># Calibration of the simulator at times of interest.</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="n">CalibrationScenario</span><span class="p">(</span>
        <span class="n">SignalGeneratorDiscipline</span><span class="p">(</span>
            <span class="c1"># The signal generator</span>
            <span class="n">calibrated_simulator</span><span class="p">,</span>
            <span class="c1"># The state variable names</span>
            <span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">],</span>
            <span class="c1"># The parameter names</span>
            <span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">],</span>
            <span class="c1"># The observable names</span>
            <span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
            <span class="c1"># The times of interest</span>
            <span class="n">times</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1"># The input variable names in the calibration data</span>
        <span class="p">[</span><span class="s2">&quot;initial_position&quot;</span><span class="p">,</span> <span class="s2">&quot;initial_velocity&quot;</span><span class="p">],</span>
        <span class="n">CalibrationMetricSettings</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="n">output_name</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="s2">&quot;MSE&quot;</span><span class="p">),</span>
        <span class="c1"># The possible values of omega</span>
        <span class="n">search_space</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">calibration</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="n">algo_name</span><span class="o">=</span><span class="s2">&quot;NLOPT_COBYLA&quot;</span><span class="p">,</span>
        <span class="n">reference_data</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;initial_position&quot;</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">initial_oscillator_position</span><span class="p">),</span>
            <span class="s2">&quot;initial_velocity&quot;</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">initial_oscillator_velocity</span><span class="p">),</span>
            <span class="n">output_name</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">oscillator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">]),</span>
        <span class="p">},</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Generation of simulations at times of interest with the calibrated simulator.</span>
    <span class="n">omega_opt</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">optimization_result</span><span class="o">.</span><span class="n">x_opt_as_dict</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">calibrated_simulator</span><span class="o">.</span><span class="n">rhs_discipline</span><span class="o">.</span><span class="n">default_input_data</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega_opt</span>
    <span class="n">calibrated_simulator_signal</span> <span class="o">=</span> <span class="n">calibrated_simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">initial_calibrated_simulator_position</span><span class="p">,</span>
            <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">initial_calibrated_simulator_velocity</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="n">new_omega</span> <span class="o">=</span> <span class="p">(</span><span class="n">full</span><span class="p">(</span><span class="n">n_sub_nodes</span><span class="p">,</span> <span class="n">omega_opt</span><span class="p">),</span> <span class="n">new_omega</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Plot the results at times of interest.</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">oscillator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Oscillator&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
        <span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Simulator&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">calibrated_simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
        <span class="s2">&quot;-.&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:green&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calibrated simulator&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calibration&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">oscillator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">full</span><span class="p">(</span><span class="n">n_sub_nodes</span><span class="p">,</span> <span class="n">omega_0</span><span class="p">),</span>
        <span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">new_omega</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;-.&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:green&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="c1"># Update the initial values of the state variables for the next iteration.</span>
    <span class="n">t_i</span> <span class="o">+=</span> <span class="n">delta</span>
    <span class="c1"># --- For the reference data.</span>
    <span class="n">final_state</span> <span class="o">=</span> <span class="n">oscillator_signal</span><span class="o">.</span><span class="n">final</span>
    <span class="n">initial_oscillator_omega</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_oscillator_position</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_oscillator_velocity</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># --- For the uncalibrated simulator.</span>
    <span class="n">final_state</span> <span class="o">=</span> <span class="n">simulator_signal</span><span class="o">.</span><span class="n">final</span>
    <span class="n">initial_simulator_position</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_simulator_velocity</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># --- For the calibrated simulator.</span>
    <span class="n">final_state</span> <span class="o">=</span> <span class="n">calibrated_simulator_signal</span><span class="o">.</span><span class="n">final</span>
    <span class="n">initial_calibrated_simulator_position</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_calibrated_simulator_velocity</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Finalize the plot.</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Angular velocity ($s^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</code></pre></div>
<p><img alt="plot ode" class="mkd-glr-single-img" src="../images/mkd_glr_plot_ode_002.png" srcset="../images/mkd_glr_plot_ode_002.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 279-298 -->

<h3 id="the-results">The results<a class="headerlink" href="#the-results" title="Permanent link">&para;</a></h3>
<p>In this graph,
the vertical lines indicate the calibration times.
We can see that
the original simulator diverges from observations as time progresses,
whereas the recalibrated simulator is close to observations
throughout the time horizon.
From an <span class="arithmatex">\(\omega\)</span> point of view,
we can see that the stairs function obtained with the recalibrated simulator
is close to the expected one, unlike that of the original model.</p>
<h2 id="one-shot-calibration">One-shot calibration<a class="headerlink" href="#one-shot-calibration" title="Permanent link">&para;</a></h2>
<h3 id="the-methodology_1">The methodology<a class="headerlink" href="#the-methodology_1" title="Permanent link">&para;</a></h3>
<p>We could also imagine the case where
the ODE defining the angular velocity is a grey box,
in the sense that only the parameter <code>a</code> is unknown.
The above then becomes:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 298-446 -->

<div class="highlight"><pre><span></span><code><span class="n">calibrated_simulator</span> <span class="o">=</span> <span class="n">Oscillator</span><span class="p">()</span>

<span class="n">search_space</span> <span class="o">=</span> <span class="n">DesignSpace</span><span class="p">()</span>
<span class="n">search_space</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

<span class="n">initial_oscillator_omega</span> <span class="o">=</span> <span class="n">omega_0</span>
<span class="n">initial_oscillator_position</span> <span class="o">=</span> <span class="n">p_0</span>
<span class="n">initial_oscillator_velocity</span> <span class="o">=</span> <span class="n">v_0</span>
<span class="n">initial_simulator_position</span> <span class="o">=</span> <span class="n">p_0</span>
<span class="n">initial_simulator_velocity</span> <span class="o">=</span> <span class="n">v_0</span>
<span class="n">initial_calibrated_simulator_omega</span> <span class="o">=</span> <span class="n">omega_0</span>
<span class="n">initial_calibrated_simulator_position</span> <span class="o">=</span> <span class="n">p_0</span>
<span class="n">initial_calibrated_simulator_velocity</span> <span class="o">=</span> <span class="n">v_0</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># The times of interest, from the initial time to the calibration time.</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">t_i</span><span class="p">,</span> <span class="n">t_i</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n_sub_nodes</span><span class="p">)</span>

    <span class="c1"># Generation of reference data at times of interest.</span>
    <span class="n">oscillator_signal</span> <span class="o">=</span> <span class="n">oscillator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">initial_oscillator_omega</span><span class="p">,</span>
            <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">initial_oscillator_position</span><span class="p">,</span>
            <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">initial_oscillator_velocity</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="c1"># Generation of simulations at times of interest with the uncalibrated simulator.</span>
    <span class="n">simulator_signal</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">initial_simulator_position</span><span class="p">,</span>
            <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">initial_simulator_velocity</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="c1"># Calibration of the simulator at times of interest.</span>
    <span class="n">calibration</span> <span class="o">=</span> <span class="n">CalibrationScenario</span><span class="p">(</span>
        <span class="n">SignalGeneratorDiscipline</span><span class="p">(</span>
            <span class="c1"># The signal generator</span>
            <span class="n">calibrated_simulator</span><span class="p">,</span>
            <span class="c1"># The state variable names</span>
            <span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">],</span>
            <span class="c1"># The parameter names</span>
            <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">],</span>
            <span class="c1"># The observable names</span>
            <span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
            <span class="c1"># The times of interest</span>
            <span class="n">times</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1"># The input variable names in the calibration data</span>
        <span class="p">[</span><span class="s2">&quot;initial_omega&quot;</span><span class="p">,</span> <span class="s2">&quot;initial_position&quot;</span><span class="p">,</span> <span class="s2">&quot;initial_velocity&quot;</span><span class="p">],</span>
        <span class="n">CalibrationMetricSettings</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="n">output_name</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="s2">&quot;MSE&quot;</span><span class="p">),</span>
        <span class="c1"># The possible values of a</span>
        <span class="n">search_space</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">calibration</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="n">algo_name</span><span class="o">=</span><span class="s2">&quot;NLOPT_COBYLA&quot;</span><span class="p">,</span>
        <span class="n">reference_data</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;initial_omega&quot;</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">initial_oscillator_omega</span><span class="p">),</span>
            <span class="s2">&quot;initial_position&quot;</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">initial_oscillator_position</span><span class="p">),</span>
            <span class="s2">&quot;initial_velocity&quot;</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">initial_oscillator_velocity</span><span class="p">),</span>
            <span class="n">output_name</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">oscillator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">]),</span>
        <span class="p">},</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Generation of simulations at times of interest with the calibrated simulator.</span>
    <span class="n">a_opt</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">optimization_result</span><span class="o">.</span><span class="n">x_opt_as_dict</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">calibrated_simulator</span><span class="o">.</span><span class="n">rhs_discipline</span><span class="o">.</span><span class="n">default_input_data</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a_opt</span>
    <span class="n">calibrated_simulator_signal</span> <span class="o">=</span> <span class="n">calibrated_simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">initial_calibrated_simulator_omega</span><span class="p">,</span>
            <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">initial_calibrated_simulator_position</span><span class="p">,</span>
            <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">initial_calibrated_simulator_velocity</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="c1"># Plot the results at times of interest.</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">oscillator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Oscillator&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
        <span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Simulator&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">calibrated_simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
        <span class="s2">&quot;-.&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:green&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calibrated simulator&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calibration&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">oscillator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">],</span>
        <span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">full</span><span class="p">(</span><span class="n">n_sub_nodes</span><span class="p">,</span> <span class="n">omega_0</span><span class="p">),</span>
        <span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span>
        <span class="n">calibrated_simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">],</span>
        <span class="s2">&quot;-.&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:green&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>

    <span class="c1"># Update the initial values of the state variables for the next iteration.</span>
    <span class="n">t_i</span> <span class="o">+=</span> <span class="n">delta</span>
    <span class="c1"># --- For the reference data.</span>
    <span class="n">final_state</span> <span class="o">=</span> <span class="n">oscillator_signal</span><span class="o">.</span><span class="n">final</span>
    <span class="n">initial_oscillator_omega</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_oscillator_position</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_oscillator_velocity</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># --- For the uncalibrated simulator.</span>
    <span class="n">final_state</span> <span class="o">=</span> <span class="n">simulator_signal</span><span class="o">.</span><span class="n">final</span>
    <span class="n">initial_simulator_position</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_simulator_velocity</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># --- For the calibrated simulator.</span>
    <span class="n">final_state</span> <span class="o">=</span> <span class="n">calibrated_simulator_signal</span><span class="o">.</span><span class="n">final</span>
    <span class="n">initial_calibrated_simulator_omega</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_calibrated_simulator_position</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">initial_calibrated_simulator_velocity</span> <span class="o">=</span> <span class="n">final_state</span><span class="p">[</span><span class="s2">&quot;velocity&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Finalize the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Angular velocity ($s^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</code></pre></div>
<p><img alt="plot ode" class="mkd-glr-single-img" src="../images/mkd_glr_plot_ode_003.png" srcset="../images/mkd_glr_plot_ode_003.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 447-462 -->

<h3 id="the-results_1">The results<a class="headerlink" href="#the-results_1" title="Permanent link">&para;</a></h3>
<p>We can see that in this case,
the simulations of the calibrated model are equal to the observations.
Of course,
we are in a special configuration where we know the shape of the grey box.
In practice,
we could use a parametric model of <span class="arithmatex">\(\omega\)</span>,
e.g. a machine learning model,
whose parameters would be calibrated.</p>
<h2 id="initial-conditions">Initial conditions<a class="headerlink" href="#initial-conditions" title="Permanent link">&para;</a></h2>
<p>Lastly,
we may want to calibrate the initial conditions of the simulator,
such as the initial position which would be incorrect
(but the ODE model of <span class="arithmatex">\(\omega\)</span> is correct):</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 462-465 -->

<div class="highlight"><pre><span></span><code><span class="n">wrong_p_0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">Oscillator</span><span class="p">()</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">rhs_discipline</span><span class="o">.</span><span class="n">default_input_data</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrong_p_0</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 466-469 -->

<h3 id="the-methodology_2">The methodology<a class="headerlink" href="#the-methodology_2" title="Permanent link">&para;</a></h3>
<p>For that,
we suppose that the initial position belongs to the interval <span class="arithmatex">\([-2,2]\)</span>:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 469-473 -->

<div class="highlight"><pre><span></span><code><span class="n">search_space</span> <span class="o">=</span> <span class="n">DesignSpace</span><span class="p">()</span>
<span class="n">search_space</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span>
    <span class="s2">&quot;initial_position&quot;</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=-</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">wrong_p_0</span>
<span class="p">)</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 474-475 -->

<p>and we generate a short signal with the reference oscillator:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 475-480 -->

<div class="highlight"><pre><span></span><code><span class="n">times</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_0</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n_sub_nodes</span><span class="p">)</span>
<span class="n">calibrated_simulator</span> <span class="o">=</span> <span class="n">Oscillator</span><span class="p">()</span>
<span class="n">simulator_signal</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">omega_0</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">p_0</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">v_0</span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 481-483 -->

<p>Then,
we calibrate the simulator:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 483-511 -->

<div class="highlight"><pre><span></span><code><span class="n">calibration</span> <span class="o">=</span> <span class="n">CalibrationScenario</span><span class="p">(</span>
    <span class="n">SignalGeneratorDiscipline</span><span class="p">(</span>
        <span class="c1"># The signal generator</span>
        <span class="n">calibrated_simulator</span><span class="p">,</span>
        <span class="c1"># The state variable names</span>
        <span class="p">[</span><span class="s2">&quot;omega&quot;</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">],</span>
        <span class="c1"># The parameter names</span>
        <span class="p">[],</span>
        <span class="c1"># The observable names</span>
        <span class="p">[</span><span class="n">output_name</span><span class="p">],</span>
        <span class="c1"># The times of interest</span>
        <span class="n">times</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1"># The input variable names in the calibration data</span>
    <span class="p">[</span><span class="s2">&quot;initial_omega&quot;</span><span class="p">,</span> <span class="s2">&quot;initial_velocity&quot;</span><span class="p">],</span>
    <span class="n">CalibrationMetricSettings</span><span class="p">(</span><span class="n">output_name</span><span class="o">=</span><span class="n">output_name</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="s2">&quot;MSE&quot;</span><span class="p">),</span>
    <span class="c1"># The possible values of a</span>
    <span class="n">search_space</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">calibration</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="n">algo_name</span><span class="o">=</span><span class="s2">&quot;NLOPT_COBYLA&quot;</span><span class="p">,</span>
    <span class="n">reference_data</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;initial_omega&quot;</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">omega_0</span><span class="p">),</span>
        <span class="s2">&quot;initial_velocity&quot;</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">v_0</span><span class="p">),</span>
        <span class="n">output_name</span><span class="p">:</span> <span class="n">atleast_2d</span><span class="p">(</span><span class="n">simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="n">output_name</span><span class="p">]),</span>
    <span class="p">},</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 512-514 -->

<h3 id="the-results_2">The results<a class="headerlink" href="#the-results_2" title="Permanent link">&para;</a></h3>
<p>Finally, we plot the results:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 514-541 -->

<div class="highlight"><pre><span></span><code><span class="n">p_0_opt</span> <span class="o">=</span> <span class="n">calibration</span><span class="o">.</span><span class="n">optimization_result</span><span class="o">.</span><span class="n">x_opt_as_dict</span><span class="p">[</span><span class="s2">&quot;initial_position&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_n</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">)</span>
<span class="n">simulator_signal</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">omega_0</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">wrong_p_0</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">v_0</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">calibrated_simulator_signal</span> <span class="o">=</span> <span class="n">calibrated_simulator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="n">omega_0</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">p_0_opt</span><span class="p">,</span> <span class="s2">&quot;velocity&quot;</span><span class="p">:</span> <span class="n">v_0</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">],</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Oscillator&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">simulator_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span>
    <span class="n">simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">],</span>
    <span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Simulator&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">calibrated_simulator_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span>
    <span class="n">calibrated_simulator_signal</span><span class="o">.</span><span class="n">evolution</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">],</span>
    <span class="s2">&quot;-.&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:green&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Calibrated simulator&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</code></pre></div>
<p><img alt="plot ode" class="mkd-glr-single-img" src="../images/mkd_glr_plot_ode_004.png" srcset="../images/mkd_glr_plot_ode_004.png" /></p>
<p class="mkd-glr-script-out">Out:</p>
<div class="mkd-glr-script-out-disp highlight"><pre><span></span><code>&lt;matplotlib.legend.Legend<span class="w"> </span>object<span class="w"> </span>at<span class="w"> </span>0x7dd8766366d0&gt;
</code></pre></div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  19.411 seconds)</p>
<div id="download_links"></div>

<p><a class="md-button center" href="../plot_ode.py"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48"/></svg></span> Download Python source code: plot_ode.py</a></p>
<p><a class="md-button center" href="../plot_ode.ipynb"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48"/></svg></span> Download Jupyter notebook: plot_ode.ipynb</a></p>
<p><a class="mkd-glr-signature" href="https://smarie.github.io/mkdocs-gallery">Gallery generated by mkdocs-gallery</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.instant", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>